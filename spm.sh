#!/bin/bash

[[ "$PAKLIB_ROOT" == "" ]] && export PAKLIB_ROOT=$(pwd -P)/.spm/paklib

function untar_payload {
	match=$(grep --text --line-number '^PAYLOAD:$' $0 | cut -d ':' -f 1)
	payload_start=$((match + 1))
	tail -n +$payload_start $0 | base64 -d | tar -xjf -
}

if [[ ! -d "${PAKLIB_ROOT}" ]]; then
	untar_payload
fi
export LUA_PATH=${PAKLIB_ROOT}/?.lua
lua ${PAKLIB_ROOT}/main.lua $@
exit $?
PAYLOAD:
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
